(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2668:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),s(908),s(1506),s(5866);var i=s(3191),r=s(8716),l=s(7922),n=s.n(l),a=s(5231),o={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>a[e]);s.d(t,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,908)),"/Users/brooks/Desktop/sales-booster/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,1506)),"/Users/brooks/Desktop/sales-booster/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/brooks/Desktop/sales-booster/app/page.tsx"],u="/page",x={require:s,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2027:()=>{},2592:(e,t,s)=>{Promise.resolve().then(s.bind(s,1590))},8784:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},1590:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var i=s(326),r=s(7577);function l(e){let t=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");return(t=(t=(t=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")).replace(/(^|[^\*])\*(?!\*)([^*]+?)\*(?=$|[^\*])/g,(e,t,s)=>`${t}<em>${s}</em>`)).replace(/^Q:\s*/i,"<strong>Q:</strong> ")).replace(/^A:\s*/i,"<strong>A:</strong> ")}function n(e){let t=e.split(/\r?\n/),s=[],i=!1,r=()=>{i&&(s.push("</ul>"),i=!1)};for(let e of t){let t=e.trimEnd().trim();if(!t){r();continue}if(/^###\s+/.test(t)){r(),s.push(`<h3>${l(t.replace(/^###\s+/,""))}</h3>`);continue}if(/^##\s+/.test(t)){r(),s.push(`<h2>${l(t.replace(/^##\s+/,""))}</h2>`);continue}if(/^#\s+/.test(t)){r(),s.push(`<h1>${l(t.replace(/^#\s+/,""))}</h1>`);continue}if(/^[-•]\s+/.test(t)){i||(s.push('<ul class="sb-list">'),i=!0),s.push(`<li>${l(t.replace(/^[-•]\s+/,""))}</li>`);continue}if(/^[A-Za-z0-9 &]+:\s*$/.test(t)){r(),s.push(`<h4>${l(t.replace(/:$/,""))}</h4>`);continue}r(),s.push(`<p>${l(t)}</p>`)}return r(),s.join("")}let a="max-w-[75%] rounded-2xl bg-[#F3E7E2] px-4 py-3 text-sm text-slate-800",o="max-w-[75%] rounded-2xl bg-white px-4 py-3 text-sm text-slate-900",c=/uploaded image:\s*(https?:\/\/\S+)/i,d=e=>e.replace(/\[b\]/gi,"**").replace(/\[\/b\]/gi,"**").replace(/\[i\]/gi,"*").replace(/\[\/i\]/gi,"*").replace(/\[u\]|\[center\]|\[size=\d+\]/gi,"").replace(/\[\/u\]|\[\/center\]|\[\/size\]/gi,"");function u({message:e}){let t=c.exec(e.content);if(t){let[,s]=t,r="user"===e.role?"text-slate-600":"text-slate-500",l="user"===e.role?"overflow-hidden rounded-lg border border-[#e6d7d0] bg-white":"overflow-hidden rounded-lg border border-border bg-white";return i.jsx("div",{className:"user"===e.role?a:o,children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[i.jsx("p",{className:`text-xs uppercase tracking-wide ${r}`,children:"Uploaded image"}),i.jsx("div",{className:l,children:i.jsx("img",{src:s,alt:"Uploaded listing reference",className:"max-h-56 w-full object-cover"})})]})})}let s=n(d(e.content)),r="user"===e.role?"rich-text text-slate-800 [&>h3]:text-slate-600 [&>p]:text-slate-700 [&_.sb-bullet]:text-slate-700 [&>strong]:text-slate-900":"rich-text";return i.jsx("div",{className:"user"===e.role?a:o,children:i.jsx("div",{className:r,dangerouslySetInnerHTML:{__html:s}})})}let x=e=>`/api${e}`,p="bg-panel border border-border rounded-xl p-5 flex flex-col min-h-0",f="bg-panel border border-border rounded-xl p-5 min-h-0",m="inline-flex items-center justify-center rounded-lg border border-transparent bg-accent px-4 py-2 text-sm font-semibold text-white transition hover:bg-accent/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent disabled:cursor-not-allowed disabled:opacity-60",h="inline-flex items-center justify-center rounded-lg border border-transparent bg-accent px-3 py-2 text-xs font-semibold text-white transition hover:bg-accent/90 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent disabled:cursor-not-allowed disabled:opacity-60",g="w-full rounded-lg border border-border bg-white px-4 py-3 text-sm text-slate-900 placeholder-muted transition focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/40 disabled:cursor-not-allowed disabled:opacity-60";async function b(e){try{return await e.json()}catch{return null}}function y(){let[e,t]=(0,r.useState)(null),[s,l]=(0,r.useState)(!1),[n,a]=(0,r.useState)(!1),[o,c]=(0,r.useState)(null),[d,y]=(0,r.useState)(""),[v,w]=(0,r.useState)([]),[N,S]=(0,r.useState)(null),[k,E]=(0,r.useState)(""),[P,$]=(0,r.useState)(!1),[C,_]=(0,r.useState)(null),[T,D]=(0,r.useState)(null),U=(0,r.useRef)(null);async function L(){let e=d.trim();if(!e){c("Email is required.");return}a(!0),c(null);try{let s=await fetch(x("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e}),credentials:"include"}),i=await b(s);if(!s.ok)throw Error(i?.error||"Sign in failed");t(i?.user??null),y("")}catch(e){console.error(e),c(e.message||"Sign in failed")}finally{a(!1),l(!0)}}async function A(){a(!0);try{await fetch(x("/auth/login"),{method:"DELETE",credentials:"include"})}catch(e){console.error(e)}finally{t(null),w([]),S(null),c(null),y(""),a(!1)}}function q(e){c(e||"Session expired. Please sign in again."),t(null)}async function M(){if(e)try{let e=await fetch(x("/listings"),{credentials:"include"});if(401===e.status){q();return}if(!e.ok){let t=await b(e);throw Error(t?.error||`Error ${e.status}`)}let t=await e.json();w(t.listings||[])}catch(e){console.error(e),_(e.message||"Failed to load listings")}}async function O(t){if(e)try{let e=await fetch(x(`/listings/${t}`),{credentials:"include"});if(401===e.status){q();return}if(!e.ok){let t=await b(e);throw Error(t?.error||`Error ${e.status}`)}let s=await e.json();S(s.listing),w(e=>Array.isArray(e)?e.some(e=>e.id===s.listing.id)?e.map(e=>e.id===s.listing.id?{...e,...s.listing}:e):[s.listing,...e]:[s.listing]);let i=new URL(window.location.href);i.searchParams.set("l",t),history.replaceState({},"",i.toString())}catch(e){console.error(e),_(e.message||"Failed to load listing")}}async function z(){if(!e){q("Please sign in to create a listing.");return}$(!0);try{let e=await fetch(x("/listings"),{method:"POST",headers:{"Content-Type":"application/json"},body:"{}",credentials:"include"});if(401===e.status){q();return}if(!e.ok){let t=await b(e);throw Error(t?.error||`Error ${e.status}`)}let t=await e.json();await M(),await O(t.listing.id)}catch(e){console.error(e),_(e.message||"Error creating listing")}finally{$(!1)}}async function R(){if(!e){q();return}$(!0);try{await M(),S(null),E(""),_(null),D(null);let e=new URL(window.location.href);e.searchParams.delete("l"),history.replaceState({},"",e.toString())}finally{$(!1)}}async function G(t){if(!e){q();return}$(!0);try{let e=await fetch(x(`/listings/${t}`),{method:"DELETE",credentials:"include"});if(401===e.status){q();return}if(!e.ok){let t=await b(e);throw Error(t?.error||`Error ${e.status}`)}if(D(null),N?.id===t){S(null);let e=new URL(window.location.href);e.searchParams.delete("l"),history.replaceState({},"",e.toString())}await M()}catch(e){console.error(e),_(e.message||"Delete failed")}finally{$(!1)}}async function B(){if(N||!e)return N;try{let e=await fetch(x("/listings"),{method:"POST",headers:{"Content-Type":"application/json"},body:"{}",credentials:"include"});if(401===e.status)return q(),null;if(!e.ok){let t=await b(e);throw Error(t?.error||`Error ${e.status}`)}let t=await e.json();return S(t.listing),await M(),t.listing}catch(e){return console.error(e),_(e.message||"Error creating listing"),null}}async function F(t,s,i){if(!e){q();return}let r=N??await B();if(r){$(!0);try{let e=await fetch(x(`/listings/${r.id}/generate`),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:t,message:s,imageUrl:i}),credentials:"include"});if(401===e.status){q();return}if(!e.ok){let t=await b(e);throw Error(t?.error||`Error ${e.status}`)}let l=await e.json();S(l.listing),w(e=>Array.isArray(e)?e.some(e=>e.id===l.listing.id)?e.map(e=>e.id===l.listing.id?{...e,...l.listing}:e):[l.listing,...e]:[l.listing])}catch(e){console.error(e),_(e.message||"Generation failed")}finally{$(!1)}}}async function I(t){if(!e)return;let s=N??await B();if(s)try{let e=await fetch(x(`/listings/${s.id}/upload-url`),{method:"POST",credentials:"include"});if(401===e.status){q();return}if(!e.ok){let t=await b(e);throw Error(t?.error||`Error ${e.status}`)}let{uploadUrl:i,path:r}=await e.json();if(!(await fetch(i,{method:"PUT",headers:{"Content-Type":t.type},body:t})).ok)throw Error("Upload failed");let l=await fetch(x(`/listings/${s.id}/image-url`),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({path:r})});if(401===l.status){q();return}if(!l.ok){let e=await b(l);throw Error(e?.error||`Image sign error ${l.status}`)}let{signedUrl:n}=await l.json();if(!n)throw Error("Missing signed image URL");await F("read",void 0,n)}catch(e){console.error(e),_(e.message||"Upload failed")}}function K(e){e&&(navigator.clipboard.writeText(e),_("Copied"),setTimeout(()=>_(null),1200))}return i.jsx("div",{className:"min-h-screen bg-background px-6 py-6 text-foreground",children:s?e?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"grid h-[calc(100vh-48px)] grid-cols-[320px_minmax(0,1fr)_320px] gap-6",children:[(0,i.jsxs)("aside",{className:p,children:[(0,i.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[i.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"My Listings"}),i.jsx("button",{onClick:z,disabled:P||n,className:h,children:"+ New Listing"})]}),i.jsx("div",{className:"flex flex-col gap-3 overflow-y-auto pr-1",children:0===v.length?i.jsx("p",{className:"text-sm text-muted",children:"No listings yet. Create one to get started."}):v.map(e=>{let t=N?.id===e.id;return(0,i.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>{D(null),O(e.id)},onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),D(null),O(e.id))},className:`relative flex cursor-pointer items-center justify-between gap-3 rounded-xl border px-4 py-3 text-left transition focus:outline-none focus:ring-2 focus:ring-accent/40 ${t?"border-accent ring-2 ring-accent/20":"border-border hover:border-accent/60"}`,children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:e.title||"Untitled draft"}),i.jsx("span",{className:"text-xs text-muted",children:e.id.slice(0,8)})]}),(0,i.jsxs)("div",{className:"relative","data-ellipsis-menu":!0,children:[i.jsx("button",{type:"button","aria-label":"Listing options",className:"rounded-md p-1 text-slate-400 transition hover:bg-accentMuted/60 hover:text-slate-700",onClick:t=>{t.stopPropagation(),D(t=>t===e.id?null:e.id)},onKeyDown:e=>e.stopPropagation(),children:"⋮"}),T===e.id&&i.jsx("div",{className:"absolute right-0 top-full z-20 mt-2 flex min-w-[130px] flex-col rounded-md border border-border bg-white",children:i.jsx("button",{type:"button",className:"w-full rounded-md px-3 py-2 text-left text-sm font-semibold text-danger transition hover:bg-red-50",onClick:t=>{t.stopPropagation(),G(e.id)},children:"Delete"})})]})]},e.id)})})]}),(0,i.jsxs)("div",{className:"relative grid grid-rows-[auto_minmax(0,1fr)_auto] gap-4 overflow-hidden",children:[(0,i.jsxs)("section",{className:`${f} flex items-center justify-between`,children:[(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-xl font-semibold text-slate-900",children:"Sales Booster"}),i.jsx("p",{className:"text-xs text-muted",children:"Etsy Listing Generator"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted",children:[(0,i.jsxs)("span",{children:["Signed in as ",e.email||`${e.id.slice(0,8)}...`]}),i.jsx("button",{onClick:()=>void R(),disabled:P||n,className:h,children:"Refresh"}),i.jsx("button",{onClick:()=>void A(),disabled:n||P,className:"inline-flex items-center justify-center rounded-lg border border-border bg-white px-3 py-1.5 text-xs font-semibold text-slate-900 transition hover:bg-accentMuted focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent disabled:cursor-not-allowed disabled:opacity-60",children:"Sign out"})]})]}),i.jsx("section",{className:`${f} flex flex-col overflow-hidden`,children:N?i.jsx("div",{className:"flex flex-col gap-3 overflow-y-auto pr-2",children:N.chat_history?.map((e,t)=>i.jsx("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:i.jsx(u,{message:e})},t))}):i.jsx("p",{className:"text-sm text-muted",children:"Create or select a listing to start."})}),i.jsx("section",{className:f,children:(0,i.jsxs)("div",{className:"flex items-stretch gap-3",children:[i.jsx("input",{ref:U,type:"file",accept:"image/*",className:"hidden",onChange:e=>{let t=e.target.files?.[0];t&&I(t),U.current&&(U.current.value="")}}),i.jsx("button",{disabled:!N||P||n,className:m,onClick:()=>U.current?.click(),children:"Upload Image"}),i.jsx("input",{value:k,onChange:e=>E(e.target.value),placeholder:"Describe your product...",className:`${g} flex-1`,disabled:n,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),N&&!P&&!n&&k&&(E(""),F("chat",k)))}}),i.jsx("button",{disabled:!N||P||n||!k,className:m,onClick:()=>{E(""),F("chat",k)},children:"Send"})]})}),P&&i.jsx("div",{className:"absolute inset-0 z-20 flex items-center justify-center rounded-xl bg-white/75",children:i.jsx("div",{className:"h-11 w-11 animate-spin rounded-full border-4 border-accent/30 border-t-accent",role:"status","aria-live":"polite","aria-label":"Loading"})})]}),(0,i.jsxs)("aside",{className:`${p} overflow-y-auto`,children:[i.jsx("h2",{className:"mb-3 text-base font-semibold text-slate-900",children:"Listing Assets"}),(0,i.jsxs)("div",{className:"flex flex-col gap-3 pr-1",children:[i.jsx(j,{title:"Title",text:N?.title,onCopy:()=>K(N?.title)}),i.jsx(j,{title:"Tags (13)",text:N?.tags,onCopy:()=>K(N?.tags)}),i.jsx(j,{title:"Description (BB-code)",text:N?.description,onCopy:()=>K(N?.description)}),i.jsx(j,{title:"FAQs",text:N?.faqs,onCopy:()=>K(N?.faqs)})]})]})]}),C&&i.jsx("div",{className:"fixed bottom-6 left-1/2 z-30 -translate-x-1/2 transform rounded-xl border border-border bg-white px-4 py-2 text-sm font-semibold text-slate-900",children:C})]}):i.jsx("div",{className:"flex min-h-[80vh] items-center justify-center",children:(0,i.jsxs)("div",{className:"w-full max-w-md space-y-6 rounded-2xl border border-border bg-panel p-8",children:[(0,i.jsxs)("div",{children:[i.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Sign in"}),i.jsx("p",{className:"mt-2 text-sm text-muted",children:"Enter the email you use for Sales Booster listings."})]}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),L()},className:"space-y-3",children:[i.jsx("input",{value:d,onChange:e=>y(e.target.value),placeholder:"you@example.com",className:g,disabled:n,type:"email"}),i.jsx("button",{type:"submit",className:m,disabled:n,children:n?"Signing in...":"Continue"})]}),o&&i.jsx("div",{className:"text-sm font-semibold text-danger",children:o})]})}):i.jsx("div",{className:"flex min-h-[60vh] items-center justify-center",children:i.jsx("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-accent/30 border-t-accent",role:"status","aria-live":"polite","aria-label":"Checking session"})})})}function j({title:e,text:t,onCopy:s}){return(0,i.jsxs)("div",{className:"bg-panel border border-border rounded-xl p-4 min-h-0",children:[(0,i.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[i.jsx("div",{className:"text-sm font-semibold text-slate-900",children:e}),i.jsx("button",{onClick:s,className:"inline-flex items-center justify-center rounded-lg border border-border bg-white px-2 py-1 text-xs font-semibold text-slate-900 transition hover:bg-accentMuted focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent disabled:cursor-not-allowed disabled:opacity-60",children:"Copy"})]}),function(e){if(!e)return i.jsx("span",{className:"text-sm text-muted",children:"—"});let t=e.replace(/\[b\]/gi,"**").replace(/\[\/b\]/gi,"**").replace(/\[i\]/gi,"*").replace(/\[\/i\]/gi,"*").replace(/\[u\]|\[center\]|\[size=\d+\]/gi,"").replace(/\[\/u\]|\[\/center\]|\[\/size\]/gi,"");return i.jsx("div",{className:"rich-text",dangerouslySetInnerHTML:{__html:n(t)}})}(t)]})}},1506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>r});var i=s(9510);s(7272);let r={title:"Sales Booster"};function l({children:e}){return i.jsx("html",{lang:"en",children:i.jsx("body",{id:"salesbooster-root",className:"bg-background text-foreground antialiased",children:e})})}},908:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});let i=(0,s(8570).createProxy)(String.raw`/Users/brooks/Desktop/sales-booster/app/page.tsx#default`)},7272:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),i=t.X(0,[276,471],()=>s(2668));module.exports=i})();